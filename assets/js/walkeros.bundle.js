(()=>{var Tt=Object.defineProperty;var Lt={};((e,t)=>{for(var n in t)Tt(e,n,{get:t[n],enumerable:!0})})(Lt,{Level:()=>ae});var ae=(e=>(e[e.ERROR=0]="ERROR",e[e.INFO=1]="INFO",e[e.DEBUG=2]="DEBUG",e))(ae||{});var Rt={merge:!0,shallow:!0,extend:!0};function S(e,t={},n={}){n={...Rt,...n};let r=Object.entries(t).reduce((o,[i,s])=>{let a=e[i];return n.merge&&Array.isArray(a)&&Array.isArray(s)?o[i]=s.reduce((c,u)=>c.includes(u)?c:[...c,u],[...a]):(n.extend||i in e)&&(o[i]=s),o},{});return n.shallow?{...e,...r}:(Object.assign(e,r),e)}function q(e){return Array.isArray(e)}function qt(e){return typeof e=="boolean"}function D(e){return e!==void 0}function ce(e){return typeof e=="function"}function Nt(e){return typeof e=="number"&&!Number.isNaN(e)}function C(e){return typeof e=="object"&&e!==null&&!q(e)&&Object.prototype.toString.call(e)==="[object Object]"}function ue(e){return typeof e=="string"}function Y(e,t=new WeakMap){if(typeof e!="object"||e===null)return e;if(t.has(e))return t.get(e);let n=Object.prototype.toString.call(e);if(n==="[object Object]"){let r={};t.set(e,r);for(let o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=Y(e[o],t));return r}if(n==="[object Array]"){let r=[];return t.set(e,r),e.forEach(o=>{r.push(Y(o,t))}),r}if(n==="[object Date]")return new Date(e.getTime());if(n==="[object RegExp]"){let r=e;return new RegExp(r.source,r.flags)}return e}function qe(e,t="",n){let r=t.split("."),o=e;for(let i=0;i<r.length;i++){let s=r[i];if(s==="*"&&q(o)){let a=r.slice(i+1).join("."),c=[];for(let u of o){let d=qe(u,a,n);c.push(d)}return c}if(o=o instanceof Object?o[s]:void 0,!o)break}return D(o)?o:n}function Te(e,t,n){if(!C(e))return e;let r=Y(e),o=t.split("."),i=r;for(let s=0;s<o.length;s++){let a=o[s];s===o.length-1?i[a]=n:(a in i&&typeof i[a]=="object"&&i[a]!==null||(i[a]={}),i=i[a])}return r}function ee(e,t={},n={}){let r={...t,...n},o={},i=e===void 0;return Object.keys(r).forEach(s=>{r[s]&&(o[s]=!0,e&&e[s]&&(i=!0))}),!!i&&o}function le(e=6){let t="";for(let n=36;t.length<e;)t+=(Math.random()*n|0).toString(n);return t}function Ne(e,t=1e3,n=!1){let r,o=null,i=!1;return(...s)=>new Promise(a=>{let c=n&&!i;o&&clearTimeout(o),o=setTimeout(()=>{o=null,n&&!i||(r=e(...s),a(r))},t),c&&(i=!0,r=e(...s),a(r))})}function pe(e){return{message:e.message,name:e.name,stack:e.stack,cause:e.cause}}function Le(e,t){let n,r={};return e instanceof Error?(n=e.message,r.error=pe(e)):n=e,t!==void 0&&(t instanceof Error?r.error=pe(t):typeof t=="object"&&t!==null?(r={...r,...t},"error"in r&&r.error instanceof Error&&(r.error=pe(r.error))):r.value=t),{message:n,context:r}}var ie=(e,t,n,r)=>{let o=`${ae[e]}${r.length>0?` [${r.join(":")}]`:""}`,i=Object.keys(n).length>0;e===0?i?console.error(o,t,n):console.error(o,t):i?console.log(o,t,n):console.log(o,t)};function Me(e={}){return We({level:e.level!==void 0?(function(t){return typeof t=="string"?ae[t]:t})(e.level):0,handler:e.handler,scope:[]})}function We(e){let{level:t,handler:n,scope:r}=e,o=(i,s,a)=>{if(i<=t){let c=Le(s,a);n?n(i,c.message,c.context,r,ie):ie(i,c.message,c.context,r)}};return{error:(i,s)=>o(0,i,s),info:(i,s)=>o(1,i,s),debug:(i,s)=>o(2,i,s),throw:(i,s)=>{let a=Le(i,s);throw n?n(0,a.message,a.context,r,ie):ie(0,a.message,a.context,r),new Error(a.message)},scope:i=>We({level:t,handler:n,scope:[...r,i]})}}function he(e){return qt(e)||ue(e)||Nt(e)||!D(e)||q(e)&&e.every(he)||C(e)&&Object.values(e).every(he)}function Re(e){return he(e)?e:void 0}function B(e,t,n){return function(...r){try{return e(...r)}catch(o){return t?t(o):void 0}finally{n?.()}}}function x(e,t,n){return async function(...r){try{return await e(...r)}catch(o){return t?await t(o):void 0}finally{await n?.()}}}async function Mt(e,t){let[n,r]=(e.name||"").split(" ");if(!t||!n||!r)return{};let o,i="",s=n,a=r,c=d=>{if(d)return(d=q(d)?d:[d]).find(f=>!f.condition||f.condition(e))};t[s]||(s="*");let u=t[s];return u&&(u[a]||(a="*"),o=c(u[a])),o||(s="*",a="*",o=c(t[s]?.[a])),o&&(i=`${s} ${a}`),{eventMapping:o,mappingKey:i}}async function R(e,t={},n={}){if(!D(e))return;let r=C(e)&&e.consent||n.consent||n.collector?.consent,o=q(t)?t:[t];for(let i of o){let s=await x(Ue)(e,i,{...n,consent:r});if(D(s))return s}}async function Ue(e,t,n={}){let{collector:r,consent:o}=n;return(q(t)?t:[t]).reduce(async(i,s)=>{let a=await i;if(a)return a;let c=ue(s)?{key:s}:s;if(!Object.keys(c).length)return;let{condition:u,consent:d,fn:f,key:l,loop:g,map:m,set:p,validate:b,value:y}=c;if(u&&!await x(u)(e,s,r))return;if(d&&!ee(d,o))return y;let h=D(y)?y:e;if(f&&(h=await x(f)(e,s,n)),l&&(h=qe(e,l,y)),g){let[w,v]=g,O=w==="this"?[e]:await R(e,w,n);q(O)&&(h=(await Promise.all(O.map(E=>R(E,v,n)))).filter(D))}else m?h=await Object.entries(m).reduce(async(w,[v,O])=>{let E=await w,_=await R(e,O,n);return D(_)&&(E[v]=_),E},Promise.resolve({})):p&&(h=await Promise.all(p.map(w=>Ue(e,w,n))));b&&!await x(b)(h)&&(h=void 0);let j=Re(h);return D(j)?j:Re(y)},Promise.resolve(void 0))}async function de(e,t,n){t.policy&&await Promise.all(Object.entries(t.policy).map(async([s,a])=>{let c=await R(e,a,{collector:n});e=Te(e,s,c)}));let{eventMapping:r,mappingKey:o}=await Mt(e,t.mapping);r?.policy&&await Promise.all(Object.entries(r.policy).map(async([s,a])=>{let c=await R(e,a,{collector:n});e=Te(e,s,c)}));let i=t.data&&await R(e,t.data,{collector:n});if(r){if(r.ignore)return{event:e,data:i,mapping:r,mappingKey:o,ignore:!0};if(r.name&&(e.name=r.name),r.data){let s=r.data&&await R(e,r.data,{collector:n});i=C(i)&&C(s)?S(i,s):s}}return{event:e,data:i,mapping:r,mappingKey:o,ignore:!1}}function T(e,t,n){return function(...r){let o,i="post"+t,s=n["pre"+t],a=n[i];return o=s?s({fn:e},...r):e(...r),a&&(o=a({fn:e,result:o},...r)),o}}var Wt={Action:"action",Actions:"actions",Config:"config",Consent:"consent",Context:"context",Custom:"custom",Destination:"destination",Elb:"elb",Globals:"globals",Hook:"hook",Init:"init",Link:"link",On:"on",Prefix:"data-elb",Ready:"ready",Run:"run",Session:"session",User:"user",Walker:"walker"},k={Commands:Wt,Utils:{Storage:{Cookie:"cookie",Local:"local",Session:"session"}}};function Ut(e,t){let n=!1,r={};return Object.entries(t).forEach(([o,i])=>{let s=!!i;r[o]=s,n=n||s}),e.consent=S(e.consent,r),{update:r,runQueue:n}}function Ht(e){return e!=null&&e!==!1&&typeof e=="object"&&e.__branch===!0}function be(e){let t={};for(let[n,r]of Object.entries(e))r.config?.next?t[n]={next:r.config.next}:t[n]={};return t}function Be(e,t){let n=e.config||{},r=e[t];return r!==void 0?{config:{...n,[t]:r},chainValue:r}:{config:n,chainValue:void 0}}function ye(e,t={}){if(!e)return[];if(Array.isArray(e))return e;let n=[],r=new Set,o=e;for(;o&&t[o]&&!r.has(o);){r.add(o),n.push(o);let i=t[o].next;if(Array.isArray(i)){n.push(...i);break}o=i}return n}async function Ft(e,t,n){if(t.init&&!t.config.init){let r=t.type||"unknown",o=e.logger.scope(`transformer:${r}`),i={collector:e,logger:o,id:n,config:t.config,env:Ve(t.config.env)};o.debug("init");let s=await T(t.init,"TransformerInit",e.hooks)(i);if(s===!1)return!1;t.config={...s||t.config,init:!0},o.debug("init done")}return!0}async function Bt(e,t,n,r,o){let i=t.type||"unknown",s=e.logger.scope(`transformer:${i}`),a={collector:e,logger:s,id:n,ingest:o,config:t.config,env:Ve(t.config.env)};s.debug("push",{event:r.name});let c=await T(t.push,"TransformerPush",e.hooks)(r,a);return s.debug("push done"),c}async function ve(e,t,n,r,o){let i=r;for(let s of n){let a=t[s];if(!a){e.logger.info(`Transformer not found: ${s}`);continue}if(!await x(Ft)(e,a,s))return e.logger.info(`Transformer init failed: ${s}`),null;let c=await x(Bt,u=>(e.logger.scope(`transformer:${a.type||"unknown"}`).error("Push failed",{error:u}),!1))(e,a,s,i,o);if(c===!1)return null;if(Ht(c)){let u=ye(c.next,be(t));return u.length>0?ve(e,t,u,c.event,o):(e.logger.info(`Branch target not found: ${JSON.stringify(c.next)}`),null)}c!==void 0&&(i=c)}return i}function Ve(e){return e&&C(e)?e:{}}async function ze(e,t,n){let{code:r,config:o={},env:i={},primary:s,next:a}=n,c,u=ye(a,be(e.transformers)),d=e.logger.scope("source").scope(t),f={push:(b,y={})=>e.push(b,{...y,id:t,ingest:c,mapping:o,preChain:u}),command:e.command,sources:e.sources,elb:e.sources.elb.push,logger:d,...i},l={collector:e,logger:d,id:t,config:o,env:f,setIngest:async b=>{c=o.ingest?await R(b,o.ingest,{collector:e}):void 0}},g=await x(r)(l);if(!g)return;let m=g.type||"unknown",p=e.logger.scope(m).scope(t);return f.logger=p,s&&(g.config={...g.config,primary:s}),g}async function Vt(e,t={}){let n={};for(let[r,o]of Object.entries(t)){let{config:i={}}=o;if(i.require&&i.require.length>0){e.pending.sources[r]=o;continue}let s=await ze(e,r,o);s&&(n[r]=s)}return n}async function zt(e,t,n){let r=e.on,o=r[t]||[],i=q(n)?n:[n];i.forEach(s=>{o.push(s)}),r[t]=o,await Ke(e,t,i)}function Ge(e,t,n,r,o){if(!t.on)return;let i=t.type||"unknown",s=e.logger.scope(i).scope("on").scope(r),a={collector:e,logger:s,id:n,config:t.config,data:o,env:J(t.env,t.config.env)};B(t.on)(r,a)}async function Ke(e,t,n,r){let o,i=n||[];switch(n||(i=e.on[t]||[]),t){case k.Commands.Consent:o=r||e.consent;break;case k.Commands.Session:o=e.session;break;case k.Commands.User:o=r||e.user;break;case k.Commands.Custom:o=r||e.custom;break;case k.Commands.Globals:o=r||e.globals;break;case k.Commands.Config:o=r||e.config;break;case k.Commands.Ready:case k.Commands.Run:default:o=void 0}let s=!1;for(let a of Object.values(e.sources))a.on&&await x(a.on)(t,o)===!1&&(s=!0);if(Object.entries(e.destinations).forEach(([a,c])=>{if(c.on){if(!c.config.init)return c.queueOn=c.queueOn||[],void c.queueOn.push({type:t,data:o});Ge(e,c,a,t,o)}}),(Object.keys(e.pending.sources).length>0||Object.keys(e.pending.destinations).length>0)&&await(async function(a,c){for(let[u,d]of Object.entries(a.pending.sources)){if(!a.pending.sources[u]||a.sources[u])continue;let f=d.config?.require;if(!f)continue;let l=f.indexOf(c);if(l===-1||(f.splice(l,1),f.length>0))continue;delete a.pending.sources[u];let g=await ze(a,u,d);g&&(a.sources[u]=g)}for(let[u,d]of Object.entries(a.pending.destinations)){if(!a.pending.destinations[u]||a.destinations[u])continue;let f=d.config?.require;if(!f)continue;let l=f.indexOf(c);if(l===-1||(f.splice(l,1),f.length>0))continue;delete a.pending.destinations[u];let g=Je(d);g.config.queue!==!1&&(g.queuePush=[...a.queue]),a.destinations[u]=g}})(e,t),!i.length)return!s;switch(t){case k.Commands.Consent:(function(a,c,u){let d=u||a.consent;c.forEach(f=>{Object.keys(d).filter(l=>l in f).forEach(l=>{B(f[l])(a,d)})})})(e,i,r);break;case k.Commands.Ready:case k.Commands.Run:(function(a,c){a.allowed&&c.forEach(u=>{B(u)(a)})})(e,i);break;case k.Commands.Session:(function(a,c){a.session&&c.forEach(u=>{B(u)(a,a.session)})})(e,i);break;default:i.forEach(a=>{typeof a=="function"&&B(a)(e,o)})}return!s}async function He(e,t,n){let{code:r,config:o={},env:i={},before:s}=t;if(!ce(r.push))return L({ok:!1,failed:{invalid:{type:"invalid",error:"Destination code must have a push method"}}});let a=n||o||{init:!1},c=s?{...a,before:s}:a,u={...r,config:c,env:J(r.env,i)},d=u.config.id;if(!d)do d=le(4);while(e.destinations[d]);return e.destinations[d]=u,u.config.queue!==!1&&(u.queuePush=[...e.queue]),fe(e,void 0,{},{[d]:u})}async function fe(e,t,n={},r){let{allowed:o,consent:i,globals:s,user:a}=e;if(!o)return L({ok:!1});t&&(e.queue.push(t),e.status.in++),r||(r=e.destinations);let c=await Promise.all(Object.entries(r||{}).map(async([l,g])=>{let m=(g.queuePush||[]).map(v=>({...v,consent:i}));if(g.queuePush=[],t){let v=Y(t);m.push(v)}if(!m.length&&!g.queueOn?.length)return{id:l,destination:g,skipped:!0};if(!m.length&&g.queueOn?.length){let v=await x(Fe)(e,g,l);return{id:l,destination:g,skipped:!v}}let p=[],b=m.filter(v=>{let O=ee(g.config.consent,i,v.consent);return!O||(v.consent=O,p.push(v),!1)});if(g.queuePush.push(...b),!p.length)return{id:l,destination:g,queue:m};if(!await x(Fe)(e,g,l))return{id:l,destination:g,queue:m};let y,h;g.dlq||(g.dlq=[]);let j=(function(v,O){let E=v.config.before;return E?ye(E,be(O)):[]})(g,e.transformers),w=0;return await Promise.all(p.map(async v=>{v.globals=S(s,v.globals),v.user=S(a,v.user);let O=v;if(j.length>0&&e.transformers&&Object.keys(e.transformers).length>0){let I=await ve(e,e.transformers,j,v,n.ingest);if(I===null)return v;O=I}let E=Date.now(),_=await x(Gt,I=>{let F=g.type||"unknown";e.logger.scope(F).error("Push failed",{error:I,event:O.name}),y=I,g.dlq.push([O,I])})(e,g,l,O,n.ingest);return w+=Date.now()-E,_!==void 0&&(h=_),v})),{id:l,destination:g,error:y,response:h,totalDuration:w}})),u={},d={},f={};for(let l of c){if(l.skipped)continue;let g=l.destination,m={type:g.type||"unknown",data:l.response};e.status.destinations[l.id]||(e.status.destinations[l.id]={count:0,failed:0,duration:0});let p=e.status.destinations[l.id],b=Date.now();l.error?(m.error=l.error,f[l.id]=m,p.failed++,p.lastAt=b,p.duration+=l.totalDuration||0,e.status.failed++):l.queue&&l.queue.length?(g.queuePush=(g.queuePush||[]).concat(l.queue),d[l.id]=m):(u[l.id]=m,p.count++,p.lastAt=b,p.duration+=l.totalDuration||0,e.status.out++)}return L({event:t,...Object.keys(u).length&&{done:u},...Object.keys(d).length&&{queued:d},...Object.keys(f).length&&{failed:f}})}async function Fe(e,t,n){if(t.init&&!t.config.init){let r=t.type||"unknown",o=e.logger.scope(r),i={collector:e,logger:o,id:n,config:t.config,env:J(t.env,t.config.env)};o.debug("init");let s=await T(t.init,"DestinationInit",e.hooks)(i);if(s===!1)return s;if(t.config={...s||t.config,init:!0},t.queueOn?.length){let a=t.queueOn;t.queueOn=[];for(let{type:c,data:u}of a)Ge(e,t,n,c,u)}o.debug("init done")}return!0}async function Gt(e,t,n,r,o){let{config:i}=t,s=await de(r,i,e);if(s.ignore)return!1;let a=t.type||"unknown",c=e.logger.scope(a),u={collector:e,logger:c,id:n,config:i,data:s.data,rule:s.mapping,ingest:o,env:J(t.env,i.env)},d=s.mapping,f=s.mappingKey||"* *";if(!d?.batch||!t.pushBatch){c.debug("push",{event:s.event.name});let l=await T(t.push,"DestinationPush",e.hooks)(s.event,u);return c.debug("push done"),l}{if(t.batches=t.batches||{},!t.batches[f]){let g={key:f,events:[],data:[]};t.batches[f]={batched:g,batchFn:Ne(()=>{let m=t.batches[f].batched,p={collector:e,logger:c,id:n,config:i,data:void 0,rule:d,ingest:o,env:J(t.env,i.env)};c.debug("push batch",{events:m.events.length}),T(t.pushBatch,"DestinationPushBatch",e.hooks)(m,p),c.debug("push batch done"),m.events=[],m.data=[]},d.batch)}}let l=t.batches[f];l.batched.events.push(s.event),D(s.data)&&l.batched.data.push(s.data),l.batchFn()}return!0}function L(e){return{ok:!e?.failed,...e}}function Je(e){let{code:t,config:n={},env:r={}}=e,{config:o}=Be(e,"before"),i={...t.config,...n,...o},s=J(t.env,r);return{...t,config:i,env:s}}async function Kt(e,t={}){let n={};for(let[r,o]of Object.entries(t))o.config?.require?.length?e.pending.destinations[r]=o:n[r]=Je(o);return n}function J(e,t){return e||t?t?e&&C(e)&&C(t)?{...e,...t}:t:e:{}}async function Jt(e,t,n,r){let o,i,s=!1,a=!1;switch(t){case k.Commands.Config:C(n)&&(S(e.config,n,{shallow:!1}),i=n,s=!0);break;case k.Commands.Consent:if(C(n)){let{update:c,runQueue:u}=Ut(e,n);i=c,s=!0,a=u}break;case k.Commands.Custom:C(n)&&(e.custom=S(e.custom,n),i=n,s=!0);break;case k.Commands.Destination:C(n)&&("code"in n&&C(n.code)?o=await He(e,n,r):ce(n.push)&&(o=await He(e,{code:n},r)));break;case k.Commands.Globals:C(n)&&(e.globals=S(e.globals,n),i=n,s=!0);break;case k.Commands.On:ue(n)&&await zt(e,n,r);break;case k.Commands.Ready:s=!0;break;case k.Commands.Run:o=await Xt(e,n),s=!0;break;case k.Commands.Session:s=!0;break;case k.Commands.User:C(n)&&(S(e.user,n,{shallow:!1}),i=n,s=!0)}return s&&await Ke(e,t,void 0,i),a&&(o=await fe(e)),o||L({ok:!0})}function Zt(e,t){if(!t.name)throw new Error("Event name is required");let[n,r]=t.name.split(" ");if(!n||!r)throw new Error("Event name is invalid");++e.count;let{timestamp:o=Date.now(),group:i=e.group,count:s=e.count}=t,{name:a=`${n} ${r}`,data:c={},context:u={},globals:d=e.globals,custom:f={},user:l=e.user,nested:g=[],consent:m=e.consent,id:p=`${o}-${i}-${s}`,trigger:b="",entity:y=n,action:h=r,timing:j=0,version:w={source:e.version,tagging:e.config.tagging||0},source:v={type:"collector",id:"",previous_id:""}}=t;return{name:a,data:c,context:u,globals:d,custom:f,user:l,nested:g,consent:m,id:p,trigger:b,entity:y,action:h,timestamp:o,timing:j,group:i,count:s,version:w,source:v}}async function Xt(e,t){return e.allowed=!0,e.count=0,e.group=le(),e.timing=Date.now(),t&&(t.consent&&(e.consent=S(e.consent,t.consent)),t.user&&(e.user=S(e.user,t.user)),t.globals&&(e.globals=S(e.config.globalsStatic||{},t.globals)),t.custom&&(e.custom=S(e.custom,t.custom))),Object.values(e.destinations).forEach(n=>{n.queuePush=[]}),e.queue=[],e.round++,await fe(e)}function Qt(e,t){return T(async(n,r={})=>await x(async()=>{let o=Date.now(),{id:i,ingest:s,mapping:a,preChain:c}=r,u=n,d=s?Object.freeze(s):void 0;if(a){let m=await de(u,a,e);if(m.ignore)return L({ok:!0});if(a.consent&&!ee(a.consent,e.consent,m.event.consent))return L({ok:!0});u=m.event}if(c?.length&&e.transformers&&Object.keys(e.transformers).length>0){let m=await ve(e,e.transformers,c,u,d);if(m===null)return L({ok:!0});u=m}let f=t(u),l=Zt(e,f),g=await fe(e,l,{id:i,ingest:d});if(i){e.status.sources[i]||(e.status.sources[i]={count:0,duration:0});let m=e.status.sources[i];m.count++,m.lastAt=Date.now(),m.duration+=Date.now()-o}return g},()=>L({ok:!1}))(),"Push",e.hooks)}async function Yt(e){let t=S({globalsStatic:{},sessionStatic:{},tagging:0,run:!0},e,{merge:!1,extend:!1}),n={level:e.logger?.level,handler:e.logger?.handler},r=Me(n),o={...t.globalsStatic,...e.globals},i={allowed:!1,config:t,consent:e.consent||{},count:0,custom:e.custom||{},destinations:{},transformers:{},globals:o,group:"",hooks:{},logger:r,on:{},queue:[],round:0,session:void 0,status:{startedAt:Date.now(),in:0,out:0,failed:0,sources:{},destinations:{}},timing:Date.now(),user:e.user||{},version:"2.0.0",sources:{},pending:{sources:{},destinations:{}},push:void 0,command:void 0};return i.push=Qt(i,s=>({timing:Math.round((Date.now()-i.timing)/10)/100,source:{type:"collector",id:"",previous_id:""},...s})),i.command=(function(s,a){return T(async(c,u,d)=>await x(async()=>await a(s,c,u,d),()=>L({ok:!1}))(),"Command",s.hooks)})(i,Jt),i.destinations=await Kt(i,e.destinations||{}),i.transformers=await(async function(s,a={}){let c={};for(let[u,d]of Object.entries(a)){let{code:f,env:l={}}=d,{config:g}=Be(d,"next"),m=s.logger.scope("transformer").scope(u),p={collector:s,logger:m,id:u,config:g,env:l},b=await f(p);c[u]=b}return c})(i,e.transformers||{}),i}async function Ze(e){e=e||{};let t=await Yt(e),n=(r=t,{type:"elb",config:{},push:async(l,g,m,p,b,y)=>{if(typeof l=="string"&&l.startsWith("walker ")){let j=l.replace("walker ","");return r.command(j,g,m)}let h;if(typeof l=="string")h={name:l},g&&typeof g=="object"&&!Array.isArray(g)&&(h.data=g);else{if(!l||typeof l!="object")return L({ok:!1});h=l,g&&typeof g=="object"&&!Array.isArray(g)&&(h.data={...h.data||{},...g})}return p&&typeof p=="object"&&(h.context=p),b&&Array.isArray(b)&&(h.nested=b),y&&typeof y=="object"&&(h.custom=y),r.push(h)}});var r;t.sources.elb=n;let o=await Vt(t,e.sources||{});Object.assign(t.sources,o);let{consent:i,user:s,globals:a,custom:c}=e;i&&await t.command("consent",i),s&&await t.command("user",s),a&&Object.assign(t.globals,a),c&&Object.assign(t.custom,c),t.config.run&&await t.command("run");let u=n.push,d=Object.values(t.sources).filter(l=>l.type!=="elb"),f=d.find(l=>l.config.primary);return f?u=f.push:d.length>0&&(u=d[0].push),{collector:t,elb:u}}function N(e,t){return(e.getAttribute(t)||"").trim()}function $(e){return{window:typeof window<"u"?window:globalThis.window,document:typeof document<"u"?document:globalThis.document,...e}}function Xe(e){let t=getComputedStyle(e);if(t.display==="none"||t.visibility!=="visible"||t.opacity&&Number(t.opacity)<.1)return!1;let n,r=window.innerHeight,o=e.getBoundingClientRect(),i=o.height,s=o.y,a=s+i,c={x:o.x+e.offsetWidth/2,y:o.y+e.offsetHeight/2};if(i<=r){if(e.offsetWidth+o.width===0||e.offsetHeight+o.height===0||c.x<0||c.x>(document.documentElement.clientWidth||window.innerWidth)||c.y<0||c.y>(document.documentElement.clientHeight||window.innerHeight))return!1;n=document.elementFromPoint(c.x,c.y)}else{let u=r/2;if(s<0&&a<u||a>r&&s>u)return!1;n=document.elementFromPoint(c.x,r/2)}if(n)do if(n===e)return!0;while(n=n.parentElement);return!1}var en=Object.defineProperty,ft=(e,t)=>{for(var n in t)en(e,n,{get:t[n],enumerable:!0})},tn=Object.defineProperty;((e,t)=>{for(var n in t)tn(e,n,{get:t[n],enumerable:!0})})({},{Level:()=>gt});var V,gt=((V=gt||{})[V.ERROR=0]="ERROR",V[V.INFO=1]="INFO",V[V.DEBUG=2]="DEBUG",V),nn={merge:!0,shallow:!0,extend:!0};function z(e,t={},n={}){n={...nn,...n};let r=Object.entries(t).reduce((o,[i,s])=>{let a=e[i];return n.merge&&Array.isArray(a)&&Array.isArray(s)?o[i]=s.reduce((c,u)=>c.includes(u)?c:[...c,u],[...a]):(n.extend||i in e)&&(o[i]=s),o},{});return n.shallow?{...e,...r}:(Object.assign(e,r),e)}function mt(e){return Array.isArray(e)}function Qe(e){return e===document||e instanceof Element}function Z(e){return typeof e=="object"&&e!==null&&!mt(e)&&Object.prototype.toString.call(e)==="[object Object]"}function W(e){return typeof e=="string"}function Ye(e){if(e==="true")return!0;if(e==="false")return!1;let t=Number(e);return e==t&&e!==""?t:String(e)}function re(e,t,n){return function(...r){try{return e(...r)}catch(o){return t?t(o):void 0}finally{n?.()}}}function je(e){return e?e.trim().replace(/^'|'$/g,"").trim():""}function P(e,t,n=!0){return e+(t=t!=null?(n?"-":"")+t:"")}function X(e,t,n,r=!0){return Pe(N(t,P(e,n,r))||"").reduce((o,i)=>{let[s,a]=ge(i);if(!s)return o;if(a||(s.endsWith(":")&&(s=s.slice(0,-1)),a=""),a.startsWith("#")){a=a.slice(1);try{let c=t[a];c||a!=="selected"||(c=t.options[t.selectedIndex].text),a=String(c)}catch{a=""}}return s.endsWith("[]")?(s=s.slice(0,-2),mt(o[s])||(o[s]=[]),o[s].push(Ye(a))):o[s]=Ye(a),o},{})}function on(e,t,n=k.Commands.Prefix){let r=[],{actions:o,nearestOnly:i}=(function(s,a,c){let u=a;for(;u;){let d=N(u,P(s,k.Commands.Actions,!1));if(d){let l=Ee(d);if(l[c])return{actions:l[c],nearestOnly:!1}}let f=N(u,P(s,k.Commands.Action,!1));if(f){let l=Ee(f);if(l[c]||c!=="click")return{actions:l[c]||[],nearestOnly:!0}}u=Ae(s,u)}return{actions:[],nearestOnly:!1}})(n,e,t);return o.length&&o.forEach(s=>{let a=Pe(s.actionParams||"",",").reduce((u,d)=>(u[je(d)]=!0,u),{}),c=pt(n,e,a,i);if(!c.length){let u="page",d=`[${P(n,u)}]`,[f,l]=$e(e,d,n,u);c.push({entity:u,data:f,nested:[],context:l})}c.forEach(u=>{r.push({entity:u.entity,action:s.action,data:u.data,trigger:t,context:u.context,nested:u.nested})})}),r}function et(e=k.Commands.Prefix,t=document){let n=P(e,k.Commands.Globals,!1),r={};return te(t,`[${n}]`,o=>{r=z(r,X(e,o,k.Commands.Globals,!1))}),r}function Ee(e){let t={};return Pe(e).forEach(n=>{let[r,o]=ge(n),[i,s]=tt(r);if(!i)return;let[a,c]=tt(o||"");a=a||i,t[i]||(t[i]=[]),t[i].push({trigger:i,triggerParams:s,action:a,actionParams:c})}),t}function pt(e,t,n,r=!1){let o=[],i=t;for(n=Object.keys(n||{}).length!==0?n:void 0;i;){let s=xe(e,i,t,n);if(s&&(o.push(s),r))break;i=Ae(e,i)}return o}function xe(e,t,n,r){let o=N(t,P(e));if(!o||r&&!r[o])return null;let i=[t],s=`[${P(e,o)}],[${P(e,"")}]`,a=P(e,k.Commands.Link,!1),c={},u=[],[d,f]=$e(n||t,s,e,o);te(t,`[${a}]`,m=>{let[p,b]=ge(N(m,a));b==="parent"&&te(document.body,`[${a}="${p}:child"]`,y=>{i.push(y);let h=xe(e,y);h&&u.push(h)})});let l=[];i.forEach(m=>{m.matches(s)&&l.push(m),te(m,s,p=>l.push(p))});let g={};return l.forEach(m=>{g=z(g,X(e,m,"")),c=z(c,X(e,m,o))}),c=z(z(g,c),d),i.forEach(m=>{te(m,`[${P(e)}]`,p=>{let b=xe(e,p);b&&u.push(b)})}),{entity:o,data:c,context:f,nested:u}}function Ae(e,t){let n=P(e,k.Commands.Link,!1);if(t.matches(`[${n}]`)){let[r,o]=ge(N(t,n));if(o==="child")return document.querySelector(`[${n}="${r}:parent"]`)}return!t.parentElement&&t.getRootNode&&t.getRootNode()instanceof ShadowRoot?t.getRootNode().host:t.parentElement}function $e(e,t,n,r){let o={},i={},s=e,a=`[${P(n,k.Commands.Context,!1)}]`,c=0;for(;s;)s.matches(t)&&(o=z(X(n,s,""),o),o=z(X(n,s,r),o)),s.matches(a)&&(Object.entries(X(n,s,k.Commands.Context,!1)).forEach(([u,d])=>{d&&!i[u]&&(i[u]=[d,c])}),++c),s=Ae(n,s);return[o,i]}function te(e,t,n){e.querySelectorAll(t).forEach(n)}function Pe(e,t=";"){if(!e)return[];let n=new RegExp(`(?:[^${t}']+|'[^']*')+`,"ig");return e.match(n)||[]}function ge(e){let[t,n]=e.split(/:(.+)/,2);return[je(t),je(n)]}function tt(e){let[t,n]=e.split("(",2);return[t,n?n.slice(0,-1):""]}var we=new WeakMap,Ce=new WeakMap,G=new WeakMap;function nt(e){let t=Date.now(),n=Ce.get(e);return(!n||t-n.lastChecked>500)&&(n={isVisible:Xe(e),lastChecked:t},Ce.set(e,n)),n.isVisible}function rn(e){if(window.IntersectionObserver)return re(()=>new window.IntersectionObserver(t=>{t.forEach(n=>{(function(r,o){var i,s;let a=o.target,c=G.get(r);if(!c)return;let u=c.timers.get(a);if(o.intersectionRatio>0){let f=Date.now(),l=we.get(a);if((!l||f-l.lastChecked>1e3)&&(l={isLarge:a.offsetHeight>window.innerHeight,lastChecked:f},we.set(a,l)),o.intersectionRatio>=.5||l.isLarge&&nt(a)){let g=(i=c.elementConfigs)==null?void 0:i.get(a);if(g?.multiple&&g.blocked)return;if(!u){let m=window.setTimeout(async()=>{var p,b;if(nt(a)){let y=(p=c.elementConfigs)==null?void 0:p.get(a);y?.context&&await M(y.context,a,y.trigger);let h=(b=c.elementConfigs)==null?void 0:b.get(a);h?.multiple?h.blocked=!0:(function(j,w){let v=G.get(j);if(!v)return;v.observer&&v.observer.unobserve(w);let O=v.timers.get(w);O&&(clearTimeout(O),v.timers.delete(w)),we.delete(w),Ce.delete(w)})(r,a)}},c.duration);c.timers.set(a,m)}return}}u&&(clearTimeout(u),c.timers.delete(a));let d=(s=c.elementConfigs)==null?void 0:s.get(a);d?.multiple&&(d.blocked=!1)})(e,n)})},{rootMargin:"0px",threshold:[0,.5]}),()=>{})()}function ot(e,t,n={multiple:!1}){var r;let o=e.settings.scope||document,i=G.get(o);i?.observer&&t&&(i.elementConfigs||(i.elementConfigs=new WeakMap),i.elementConfigs.set(t,{multiple:(r=n.multiple)!=null&&r,blocked:!1,context:e,trigger:n.multiple?"visible":"impression"}),i.observer.observe(t))}function ht(e){if(!e)return;let t=G.get(e);t&&(t.observer&&t.observer.disconnect(),G.delete(e))}function oe(e,t,n,r,o,i,s){let{elb:a,settings:c}=e;if(W(t)&&t.startsWith("walker "))return a(t,n);if(Z(t)){let p=t;return p.source||(p.source=rt()),p.globals||(p.globals=et(c.prefix,c.scope||document)),a(p)}let[u]=String(Z(t)?t.name:t).split(" "),d,f=Z(n)?n:{},l={},g=!1;if(Qe(n)&&(d=n,g=!0),Qe(o)?d=o:Z(o)&&Object.keys(o).length&&(l=o),d){let p=pt(c.prefix||"data-elb",d).find(b=>b.entity===u);p&&(g&&(f=p.data),l=p.context)}u==="page"&&(f.id=f.id||window.location.pathname);let m=et(c.prefix,c.scope);return a({name:String(t||""),data:f,context:l,globals:m,nested:i,custom:s,trigger:W(r)?r:"",source:rt()})}function rt(){return{type:"browser",id:window.location.href,previous_id:document.referrer}}var ke,ne=[],sn="click",st="hover",it="load",at="pulse",bt="scroll",an="submit",cn="impression",un="visible",ct="wait";function ln(e,t){t.scope&&(function(n,r){let o=r.scope;o&&(o.addEventListener("click",re(function(i){dn.call(this,n,i)})),o.addEventListener("submit",re(function(i){fn.call(this,n,i)})))})(e,t)}function ut(e,t){t.scope&&(function(n,r){let o=r.scope;ne=[];let i=o||document;ht(i),(function(a,c=1e3){G.has(a)||G.set(a,{observer:rn(a),timers:new WeakMap,duration:c})})(i,1e3);let s=P(r.prefix,k.Commands.Action,!1);i!==document&&lt(n,i,s,r),i.querySelectorAll(`[${s}]`).forEach(a=>{lt(n,a,s,r)}),ne.length&&(function(a,c){let u=(d,f)=>d.filter(([l,g])=>{let m=window.scrollY+window.innerHeight,p=l.offsetTop;if(m<p)return!0;let b=l.clientHeight;return!(100*(1-(p+b-m)/(b||1))>=g)||(M(f,l,bt),!1)});ke||(ke=(function(d,f=1e3){let l=null;return function(...g){if(l===null)return l=setTimeout(()=>{l=null},f),d(...g)}})(function(){ne=u.call(c,ne,a)}),c.addEventListener("scroll",ke))})(n,i)})(e,t)}async function M(e,t,n){let r=on(t,n,e.settings.prefix);return Promise.all(r.map(o=>oe(e,{name:`${o.entity} ${o.action}`,...o,trigger:n})))}function lt(e,t,n,r){let o=N(t,n);o&&Object.values(Ee(o)).forEach(i=>i.forEach(s=>{switch(s.trigger){case st:(function(a,c){c.addEventListener("mouseenter",re(function(u){u.target instanceof Element&&M(a,u.target,st)}))})(e,t);break;case it:(function(a,c){M(a,c,it)})(e,t);break;case at:(function(a,c,u=""){setInterval(()=>{document.hidden||M(a,c,at)},parseInt(u||"")||15e3)})(e,t,s.triggerParams);break;case bt:(function(a,c=""){let u=parseInt(c||"")||50;u<0||u>100||ne.push([a,u])})(t,s.triggerParams);break;case cn:ot(e,t);break;case un:ot(e,t,{multiple:!0});break;case ct:(function(a,c,u=""){setTimeout(()=>M(a,c,ct),parseInt(u||"")||15e3)})(e,t,s.triggerParams)}}))}function dn(e,t){M(e,t.target,sn)}function fn(e,t){t.target&&M(e,t.target,an)}function gn(e,t={}){let n=t.name||"elbLayer",r=t.window||window;if(!r)return;let o=r;o[n]||(o[n]=[]);let i=o[n];i.push=function(...s){if(yt(s[0])){let c=[...Array.from(s[0])],u=Array.prototype.push.apply(this,[c]);return Se(e,t.prefix,c),u}let a=Array.prototype.push.apply(this,s);return s.forEach(c=>{Se(e,t.prefix,c)}),a},Array.isArray(i)&&i.length>0&&(function(s,a="data-elb",c){dt(s,a,c,!0),dt(s,a,c,!1),c.length=0})(e,t.prefix,i)}function dt(e,t,n,r){let o=[],i=!0;n.forEach(s=>{let a=yt(s)?[...Array.from(s)]:(c=s)!=null&&typeof c=="object"&&"length"in c&&typeof c.length=="number"?Array.from(s):[s];var c;if(Array.isArray(a)&&a.length===0||Array.isArray(a)&&a.length===1&&!a[0])return;let u=a[0],d=!Z(u)&&W(u)&&u.startsWith("walker ");if(Z(u)){if(typeof u=="object"&&Object.keys(u).length===0)return}else{let f=Array.from(a);if(!W(f[0])||f[0].trim()==="")return;i&&f[0]==="walker run"&&(i=!1)}(r&&d||!r&&!d)&&o.push(a)}),o.forEach(s=>{Se(e,t,s)})}function Se(e,t="data-elb",n){re(()=>{if(Array.isArray(n)){let[r,...o]=n;if(!r||W(r)&&r.trim()==="")return;if(W(r)&&r.startsWith("walker "))return void e(r,o[0]);oe({elb:e,settings:{prefix:t,scope:document,pageview:!1,elb:"",elbLayer:!1}},r,...o)}else if(n&&typeof n=="object"){if(Object.keys(n).length===0)return;e(n)}},()=>{})()}function yt(e){return e!=null&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Arguments]"}var mn={};ft(mn,{env:()=>vt});var vt={};ft(vt,{push:()=>pn});var A=()=>{},Oe=()=>()=>Promise.resolve({ok:!0}),wt={error:A,info:A,debug:A,throw:e=>{throw typeof e=="string"?new Error(e):e},scope:()=>wt},pn={get push(){return Oe()},get command(){return Oe()},get elb(){return Oe()},get window(){return{addEventListener:A,removeEventListener:A,location:{href:"https://example.com/page",pathname:"/page",search:"?query=test",hash:"#section",host:"example.com",hostname:"example.com",origin:"https://example.com",protocol:"https:"},document:{},navigator:{language:"en-US",userAgent:"Mozilla/5.0 (Test)"},screen:{width:1920,height:1080},innerWidth:1920,innerHeight:1080,pageXOffset:0,pageYOffset:0,scrollX:0,scrollY:0}},get document(){return{addEventListener:A,removeEventListener:A,querySelector:A,querySelectorAll:()=>[],getElementById:A,getElementsByClassName:()=>[],getElementsByTagName:()=>[],createElement:()=>({setAttribute:A,getAttribute:A,addEventListener:A,removeEventListener:A}),body:{appendChild:A,removeChild:A},documentElement:{scrollTop:0,scrollLeft:0},readyState:"complete",title:"Test Page",referrer:"",cookie:""}},logger:wt};var hn=async e=>{let{config:t,env:n}=e,{elb:r,command:o,window:i,document:s}=n,a=t?.settings||{},c=i||(globalThis.window!==void 0?globalThis.window:void 0),u=s||(globalThis.document!==void 0?globalThis.document:void 0),d=(function(m={},p){return{prefix:"data-elb",pageview:!0,elb:"elb",elbLayer:"elbLayer",scope:p||void 0,...m}})(a,u),f={settings:d},l={elb:r,settings:d},g=m=>{if(m.pageview){let[p,b]=(function(y,h){let j=window.location,w="page",v=h===document?document.body:h,[O,E]=$e(v,`[${P(y,w)}]`,y,w);return O.domain=j.hostname,O.title=document.title,O.referrer=document.referrer,j.search&&(O.search=j.search),j.hash&&(O.hash=j.hash),[O,E]})(m.prefix||"data-elb",m.scope);oe(l,"page view",p,"load",b)}};return c&&u&&(d.elbLayer!==!1&&r&&gn(r,{name:W(d.elbLayer)?d.elbLayer:"elbLayer",prefix:d.prefix,window:c}),await(async function(m,p,b){let y=()=>{m(p,b)};document.readyState!=="loading"?y():document.addEventListener("DOMContentLoaded",y)})(ln,l,d),ut(l,d),g(d),W(d.elb)&&d.elb&&(c[d.elb]=(...m)=>{let[p,b,y,h,j,w]=m;return oe(l,p,b,y,h,j,w)})),{type:"browser",config:f,push:(...m)=>{let[p,b,y,h,j,w]=m;return oe(l,p,b,y,h,j,w)},destroy:async()=>{u&&ht(d.scope||u)},on:async m=>{switch(m){case"ready":default:break;case"run":u&&c&&(ut(l,d),g(d))}}}},kt=hn;var Ot=new Set;function jt(e,t="https://www.googletagmanager.com/gtag/js?id=",n=globalThis.document){if(Ot.has(e))return;let r=n.createElement("script");r.src=t+e,n.head.appendChild(r),Ot.add(e)}function Et(e){let t=e;return t.dataLayer=t.dataLayer||[],t.gtag||(t.gtag=function(){t.dataLayer.push(arguments)}),t.gtag}var bn=Object.defineProperty;((e,t)=>{for(var n in t)bn(e,n,{get:t[n],enumerable:!0})})({},{Level:()=>At});var K,At=((K=At||{})[K.ERROR=0]="ERROR",K[K.INFO=1]="INFO",K[K.DEBUG=2]="DEBUG",K),yn={merge:!0,shallow:!0,extend:!0};function xt(e,t={},n={}){n={...yn,...n};let r=Object.entries(t).reduce((o,[i,s])=>{let a=e[i];return n.merge&&Array.isArray(a)&&Array.isArray(s)?o[i]=s.reduce((c,u)=>c.includes(u)?c:[...c,u],[...a]):(n.extend||i in e)&&(o[i]=s),o},{});return n.shallow?{...e,...r}:(Object.assign(e,r),e)}function Q(e){return Array.isArray(e)}function U(e){return e!==void 0}function H(e){return typeof e=="object"&&e!==null&&!Q(e)&&Object.prototype.toString.call(e)==="[object Object]"}function $t(e){return typeof e=="string"}function Pt(e,t="",n){let r=t.split("."),o=e;for(let i=0;i<r.length;i++){let s=r[i];if(s==="*"&&Q(o)){let a=r.slice(i+1).join("."),c=[];for(let u of o){let d=Pt(u,a,n);c.push(d)}return c}if(o=o instanceof Object?o[s]:void 0,!o)break}return U(o)?o:n}function De(e){return(function(t){return typeof t=="boolean"})(e)||$t(e)||(function(t){return typeof t=="number"&&!Number.isNaN(t)})(e)||!U(e)||Q(e)&&e.every(De)||H(e)&&Object.values(e).every(De)}function Ct(e){return De(e)?e:void 0}function me(e,t,n){return async function(...r){try{return await e(...r)}catch(o){return t?await t(o):void 0}finally{await n?.()}}}async function se(e,t={},n={}){var r;if(!U(e))return;let o=H(e)&&e.consent||n.consent||((r=n.collector)==null?void 0:r.consent),i=Q(t)?t:[t];for(let s of i){let a=await me(_t)(e,s,{...n,consent:o});if(U(a))return a}}async function _t(e,t,n={}){let{collector:r,consent:o}=n;return(Q(t)?t:[t]).reduce(async(i,s)=>{let a=await i;if(a)return a;let c=$t(s)?{key:s}:s;if(!Object.keys(c).length)return;let{condition:u,consent:d,fn:f,key:l,loop:g,map:m,set:p,validate:b,value:y}=c;if(u&&!await me(u)(e,s,r))return;if(d&&!(function(w,v={},O={}){let E={...v,...O},_={},I=w===void 0;return Object.keys(E).forEach(F=>{E[F]&&(_[F]=!0,w&&w[F]&&(I=!0))}),!!I&&_})(d,o))return y;let h=U(y)?y:e;if(f&&(h=await me(f)(e,s,n)),l&&(h=Pt(e,l,y)),g){let[w,v]=g,O=w==="this"?[e]:await se(e,w,n);Q(O)&&(h=(await Promise.all(O.map(E=>se(E,v,n)))).filter(U))}else m?h=await Object.entries(m).reduce(async(w,[v,O])=>{let E=await w,_=await se(e,O,n);return U(_)&&(E[v]=_),E},Promise.resolve({})):p&&(h=await Promise.all(p.map(w=>_t(e,w,n))));b&&!await me(b)(h)&&(h=void 0);let j=Ct(h);return U(j)?j:Ct(y)},Promise.resolve(void 0))}async function _e(e,t,n,r,o){let i=H(t)?t:{},s=n.data?await se(e,n.data,{collector:o}):{},a=r?.data?await se(e,r.data,{collector:o}):{},c=H(s)?s:{},u=H(a)?a:{};return xt(xt(i,c),u)}function vn(e,t,n={},r,o,i){let{window:s}=$(o);t.measurementId||i.throw("Config settings ga4.measurementId missing");let a=H(r)?r:{},c=(function(f,l){let g={};return l.includes("all")&&(l=["context","data","event","globals","source","user","version"]),l.forEach(m=>{let p=f[m]||{};m=="event"&&(p={id:f.id,timing:f.timing,trigger:f.trigger,entity:f.entity,action:f.action,group:f.group,count:f.count}),Object.entries(p).forEach(([b,y])=>{m=="context"&&(y=y[0]),g[`${m}_${b}`]=y})}),g})(e,n.include||t.include||["data"]),u={...c,...a},d=e.name;t.snakeCase!==!1&&(d=(function(f,l=!0){return l?f.replace(/\s+/g,"_").toLowerCase():f})(d)),u.send_to=t.measurementId,t.debug&&(u.debug_mode=!0),(0,s.gtag)("event",d,u)}var Ie="dataLayer";function wn(e,t,n,r){let{window:o,document:i}=$(n),{containerId:s,dataLayer:a,domain:c}=e,u=a||Ie;u===Ie?o.dataLayer=o.dataLayer||[]:o[u]=o[u]||[],o[u].push({"gtm.start":new Date().getTime(),event:"gtm.js"}),t&&s&&(function(d,f,l,g=globalThis.document){let m=l!=Ie?"&l="+l:"",p=g.createElement("script");p.src=f+d+m,g.head.appendChild(p)})(s,c||"https://www.googletagmanager.com/gtm.js?id=",u,i)}var St=!1;var kn={marketing:["ad_storage","ad_user_data","ad_personalization"],functional:["analytics_storage"]},On={type:"google-gtag",config:{settings:{}},init({config:e,env:t,logger:n}){let{settings:r={},loadScript:o}=e,{ga4:i,ads:s,gtm:a}=r;return i?.measurementId||s?.conversionId||a?.containerId||n.throw("Config settings missing. Set ga4.measurementId, ads.conversionId, or gtm.containerId"),i?.measurementId&&(function(c,u,d,f){let{window:l,document:g}=$(d),{measurementId:m,transport_url:p,server_container_url:b,pageview:y}=c;m||f.throw("Config settings ga4.measurementId missing"),u&&jt(m,void 0,g),Et(l);let h={};p&&(h.transport_url=p),b&&(h.server_container_url=b),y===!1&&(h.send_page_view=!1);let j=l.gtag;j("js",new Date),j("config",m,h)})(i,o,t,n),s?.conversionId&&(function(c,u,d,f){let{window:l,document:g}=$(d),{conversionId:m}=c;m||f.throw("Config settings ads.conversionId missing"),c.currency||(c.currency="EUR"),u&&jt(m,void 0,g),Et(l);let p=l.gtag;p("js",new Date),p("config",m)})(s,o,t,n),a?.containerId&&wn(a,o,t),e},async push(e,{config:t,rule:n={},data:r,env:o,collector:i,logger:s}){let{settings:a={}}=t,{ga4:c,ads:u,gtm:d}=a,f=n.settings||{},l=await _e(e,r,t,c,i),g=await _e(e,r,t,u,i),m=await _e(e,r,t,d,i);c?.measurementId&&vn(e,c,f.ga4,l,o,s),u?.conversionId&&n.name&&(function(p,b,y={},h,j,w,v){let{conversionId:O,currency:E}=b,_=H(h)?h:{},I=y.label||j;I||v.throw("Config mapping ads.label missing");let F={send_to:`${O}/${I}`,currency:E||"EUR",..._},{window:Dt}=$(w);(0,Dt.gtag)("event","conversion",F)})(0,u,f.ads,g,n.name,o,s),d?.containerId&&(function(p,b,y={},h,j){let{window:w}=$(j),v={event:p.name};w.dataLayer.push({...v,...H(h)?h:p})})(e,0,f.gtm,m,o)},on(e,t){var n;if(e!=="consent"||!t.data)return;let r=t.data,o=((n=t.config)==null?void 0:n.settings)||{},{como:i=!0}=o;if(!i)return;let{window:s}=$(t.env),a=s.gtag;if(!a)return;let c=i===!0?kn:i;if(!St){let d=new Set;if(Object.values(c).forEach(f=>{(Array.isArray(f)?f:[f]).forEach(l=>d.add(l))}),d.size>0){let f={};d.forEach(l=>{f[l]="denied"}),a("consent","default",f)}St=!0}let u={};Object.entries(r).forEach(([d,f])=>{let l=c[d];if(!l)return;let g=Array.isArray(l)?l:[l],m=f?"granted":"denied";g.forEach(p=>{u[p]=m})}),Object.keys(u).length!==0&&a("consent","update",u)}},It=On;(async()=>{let e={sources:{browser:{code:kt,config:{settings:{pageview:!0,session:!0,elb:"elb"}}}},destinations:{gtag:{code:It,config:{settings:{ga4:{measurementId:"G-9H6MQML5EC",pageview:!1}},mapping:{page:{view:{name:"page_view",data:{map:{page_location:"context.url",page_title:"data.title",page_referrer:"context.referrer"}}}},article:{view:{name:"content_view",data:{map:{content_type:{value:"article"},content_id:"data.id",content_title:"data.title",content_category:"data.category",content_tags:"data.tags"}}},read_half:{name:"scroll",data:{map:{percent_scrolled:{value:50},content_type:{value:"article"},content_id:"data.id"}}},read_complete:{name:"scroll",data:{map:{percent_scrolled:{value:90},content_type:{value:"article"},content_id:"data.id"}}}},navigation:{select:{name:"navigation_click",data:{map:{link_text:"data.destination",link_url:"data.url"}}}},tags:{select:{name:"tag_click",data:{map:{tag_name:"data.name"}}}},contact_form:{send:{name:"form_submit",data:{map:{form_name:{value:"contact"}}}}}}}}}},{collector:t,elb:n}=await Ze(e);typeof window<"u"&&(window.collector=t),typeof window<"u"&&(window.elb=n)})();})();
